var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&o(e,a,t[a]);return e};import{r as l,H as c,q as p,m as u,a as g,a_ as m,bx as d,k as b,M as v}from"./index.1e76493d.js";import{E as P}from"./el-message-box.4063e9e4.js";import"./el-button.0e8e2c99.js";import"./el-input.bdec6a0a.js";import"./el-overlay.b8f8880a.js";const{t:y}=b(),f=e=>{const n=l({pageSize:10,currentPage:1,total:10,tableList:[],paramsObj:{},loading:!0,currentRow:null}),r=c((()=>{return{params:(e=i({},n.paramsObj.params),r={pageSize:n.pageSize,pageIndex:n.currentPage},t(e,a(r)))};var e,r}));p((()=>n.currentPage),(()=>{w.getList()})),p((()=>n.pageSize),(()=>{1===n.currentPage||(n.currentPage=1),w.getList()}));const s=u(),o=u(),b=async()=>{await v();const e=g(s);return e},f=async(t,a)=>{if(await((null==e?void 0:e.delListApi)&&(null==e?void 0:e.delListApi(t)))){d.success(y("common.delSuccess"));const e=(n.total%n.pageSize===a.length||1===n.pageSize)&&n.currentPage>1?n.currentPage-1:n.currentPage;n.currentPage=e,w.getList()}},w={getList:async()=>{var t;n.loading=!0;const a=await(null==e?void 0:e.getListApi(g(r)).catch((()=>{})).finally((()=>{n.loading=!1})));a&&(n.tableList=m(a.data||{},null==e?void 0:e.response.list),n.total=m(a.data||{},null==(t=null==e?void 0:e.response)?void 0:t.total)||0)},setProps:async(e={})=>{const t=await b();null==t||t.setProps(e)},setColumn:async e=>{const t=await b();null==t||t.setColumn(e)},getSelections:async()=>{const e=await b();return(null==e?void 0:e.selections)||[]},setSearchParams:e=>{n.currentPage=1,n.paramsObj=Object.assign(n.paramsObj,{params:i({pageSize:n.pageSize,pageIndex:n.currentPage},e)}),w.getList()},delList:async(e,t,a=!0)=>{const r=await b();if(t){if(!(null==r?void 0:r.selections.length))return void d.warning(y("common.delNoData"))}else if(!n.currentRow)return void d.warning(y("common.delNoData"));const s={data:{ids:e}};a?P.confirm(y("common.delMessage"),y("common.delWarning"),{confirmButtonText:y("common.delOk"),cancelButtonText:y("common.delCancel"),type:"warning"}).then((async()=>{await f(s,e)})).catch((()=>{})):await f(s,e)}};return(null==e?void 0:e.props)&&w.setProps(e.props),{register:(e,t)=>{s.value=e,o.value=t},elTableRef:o,tableObject:n,methods:w}};export{f as u};
